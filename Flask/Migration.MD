### –ß—Ç–æ —Ç–∞–∫–æ–µ –º–∏–≥—Ä–∞—Ü–∏–∏?

–ú–∏–≥—Ä–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ **—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç **–±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ** –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã, —Å—Ç–æ–ª–±—Ü—ã –∏ –∏–Ω–¥–µ–∫—Å—ã –≤ –±–∞–∑–µ, —Å–æ—Ö—Ä–∞–Ω—è—è –¥–∞–Ω–Ω—ã–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∏—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –∫–æ–¥–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, –º–∏–≥—Ä–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π.

---

### üîπ –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏?
–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∏ –≤ –Ω–µ–º –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `users`:

| id | name  |
|----|-------|
| 1  | –ò–≤–∞–Ω  |
| 2  | –ê–Ω–Ω–∞  |

–ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è —Ç–µ–±–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `email`. –ë–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π —Ç—ã –±—ã –¥–µ–ª–∞–ª —ç—Ç–æ –≤—Ä—É—á–Ω—É—é –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é SQL-–∑–∞–ø—Ä–æ—Å–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```sql
ALTER TABLE users ADD COLUMN email VARCHAR(100);
```
–ù–æ –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—Ä—É—á–Ω—É—é –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º –∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—è–º.

–ú–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å** —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—è—Ö –¥–∞–Ω–Ω—ã—Ö.
- –°–æ–∑–¥–∞—é—Ç —Ñ–∞–π–ª—ã —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã.
- –ü–æ–∑–≤–æ–ª—è—é—Ç –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.

---

### üîπ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –º–∏–≥—Ä–∞—Ü–∏–∏?
1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**  
   –°–æ–∑–¥–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –º–∏–≥—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `migrations/`).
   
2. **–°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏**  
   –ö–æ–≥–¥–∞ —Ç—ã –∏–∑–º–µ–Ω—è–µ—à—å –º–æ–¥–µ–ª—å –≤ –∫–æ–¥–µ, —Å–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π —Å–æ–∑–¥–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏**  
   –ö–æ–º–∞–Ω–¥–∞ `upgrade` –≤–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

4. **–û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏**  
   –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

---

### üîπ –ö–∞–∫ –º–∏–≥—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–æ Flask?
–í–æ **Flask** –∑–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—á–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ **Flask-Migrate**, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Alembic**. –û–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—è—Ö **SQLAlchemy** –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π –≤–æ Flask:
```sh
flask db init       # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
flask db migrate -m "Added email field"  # –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
flask db upgrade    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
flask db downgrade  # –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
```

---

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤–æ Flask

–í–æ **Flask** –º–∏–≥—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã, –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–æ–ª–±—Ü—ã) –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö.  

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –≤–æ Flask —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ **Flask-Migrate**, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤—è–∑–∫–µ —Å **Alembic**.

---

## üîπ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Flask-Migrate
–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏, –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **Flask-Migrate**:
```sh
pip install Flask-Migrate
```

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è **Flask-SQLAlchemy**, –µ—Å–ª–∏ –µ–≥–æ –µ—â—ë –Ω–µ—Ç:
```sh
pip install Flask-SQLAlchemy
```

---

## üîπ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –≤ –ø—Ä–æ–µ–∫—Ç–µ

### 1Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å SQLAlchemy
–ü—Ä–∏–º–µ—Ä `app.py` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ Flask-Migrate:
```python
from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///database.db'  # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False

db = SQLAlchemy(app)
migrate = Migrate(app, db)  # –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏

class User(db.Model):  # –ü—Ä–∏–º–µ—Ä –º–æ–¥–µ–ª–∏
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)

if __name__ == "__main__":
    app.run(debug=True)
```

---

## üîπ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

### 2Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π
–ó–∞–ø—É—Å–∫–∞–µ–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∫–æ–º–∞–Ω–¥—É (–≤ –∫–∞—Ç–∞–ª–æ–≥–µ –ø—Ä–æ–µ–∫—Ç–∞):
```sh
flask db init
```
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç –∫–∞—Ç–∞–ª–æ–≥ `migrations/`, –≥–¥–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π.

---

## üîπ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

### 3Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –¥–æ–±–∞–≤–∏–ª–∏ –º–æ–¥–µ–ª–∏ –≤ `app.py`, —Å–æ–∑–¥–∞—ë–º –º–∏–≥—Ä–∞—Ü–∏—é:
```sh
flask db migrate -m "Initial migration"
```
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ `migrations/versions/`.

### 4Ô∏è‚É£ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
```sh
flask db upgrade
```
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤ `database.db` –ø–æ—è–≤–∏—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ `user`.

---

## üîπ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

–î–æ–ø—É—Å—Ç–∏–º, –º—ã –¥–æ–±–∞–≤–∏–ª–∏ –Ω–æ–≤–æ–µ –ø–æ–ª–µ `email` –≤ –º–æ–¥–µ–ª—å `User`:
```python
class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)  # –ù–æ–≤–æ–µ –ø–æ–ª–µ
```
–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Å–Ω–æ–≤–∞ —Å–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:
```sh
flask db migrate -m "Added email field to User"
flask db upgrade
```
–¢–µ–ø–µ—Ä—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—è–≤–∏—Ç—Å—è –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü `email`.

---

## üîπ –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é:
```sh
flask db downgrade
```
–ß—Ç–æ–±—ã –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ –Ω–∞–∑–∞–¥:
```sh
flask db downgrade -1  # –ù–∞ –æ–¥–Ω—É –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞–∑–∞–¥
```

---

## üîπ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π
–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```sh
flask db history
```

---

## üîπ –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Flask-Migrate
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `flask db init` | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–∏–≥—Ä–∞—Ü–∏–π |
| `flask db migrate -m "–û–ø–∏—Å–∞–Ω–∏–µ"` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é |
| `flask db upgrade` | –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö |
| `flask db downgrade` | –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é |
| `flask db history` | –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –º–∏–≥—Ä–∞—Ü–∏–π |
| `flask db current` | –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –º–∏–≥—Ä–∞—Ü–∏–∏ |
| `flask db stamp head` | –ü–æ–º–µ—Ç–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –∫–∞–∫ –∞–∫—Ç—É–∞–ª—å–Ω—É—é |


